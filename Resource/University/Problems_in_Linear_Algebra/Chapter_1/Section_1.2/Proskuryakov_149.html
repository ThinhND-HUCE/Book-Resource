<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài 149</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <i>Bài 149:</i><br><br>
    Để thiết lập hệ thức đệ quy này, lưu ý rằng nếu trong một hoán vị với \(k\) nghịch thế của các số \(1, 2, \ldots , n, n+1\), nếu số \(n+1\) nằm ở vị trí cuối cùng, thì tất cả \(k\) nghịch thế được hình thành bởi các số \(1, 2, \ldots , n\), và sẽ có \( \left( n, k \right) \) hoán vị như vậy; 
    nếu \(n+1\) nằm ở vị trí gần cuối, thì nó tạo ra một nghịch thế, và các số \(1, 2, \ldots , n\) tạo thành \(k-1\) nghịch thế, và sẽ có \( \left( n, k-1 \right) \) hoán vị như vậy, và cứ thế tiếp tục; 
    cuối cùng, nếu \(n+1\) nằm ở vị trí đầu tiên, thì nó tạo ra \(n\) nghịch thế (điều này chỉ có thể xảy ra nếu \(k \ge n\)), và các số \(1, 2, \ldots , n\) tạo thành \(k-n\) nghịch thế, và sẽ có \( \left( n, k-n \right) \) hoán vị như vậy.
    Theo quy tắc cộng ta có
    \[
    \left( {n + 1,k} \right) = \left( {n,k} \right) + \left( {n,k - 1} \right) + \left( {n,k - 2} \right) +  \cdots  + \left( {n,k - n} \right)
    \]


    Bằng cách sắp xếp các số \( \left( n, k \right) \) trong một bảng gồm các hàng với giá trị \(n\) cho trước và các cột với giá trị \(k\) cho trước, từ hệ thức đệ quy ta thấy mỗi số trong hàng thứ \(n+1\) bằng tổng của \(n+1\) số ở hàng trước đó, tính từ số đứng ngay trên số cần tính sang trái (bao gồm cả các số bằng~0). 
    Nếu, để thuận tiện trong việc tính toán vị trí, ta viết ra các giá trị bằng 0 của \( \left( n, j \right) \) khi \(\displaystyle j > \binom{n}{2} \) và nếu ta lưu ý rằng \( \left( 1, 0 \right) = 1 \), \( \left( 1, j \right) = 0 \) với \( j \ge 1 \), thì ta thu được bảng giá trị \( \left( n, k \right) \) như sau:

    \[
    \begin{array}{c | *{15}{r} r}\hline
    n \backslash k & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 \\ \hline
    1                                  & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0  & 0  & 0  & 0  &  0 & 0 \\ \hline
    2                                  & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0  & 0  & 0  & 0  &  0 & 0 \\ \hline
    3                                  & 1 & 2 & 2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0  & 0  & 0  & 0  &  0 & 0 \\ \hline
    4                                  & 1 & 3 & 5 & 6 & 5 & 3 & 1 & 0 & 0 & 0 & 0  & 0  & 0  & 0  &  0 & 0 \\ \hline
    5                                  & 1 & 4 & 9 &15 &20 &22 &20 &15 & 9 & 4 & 1  & 0  & 0  & 0  &  0 & 0 \\ \hline
    6                                  & 1 & 5 &14 &29 &49 &71 &90 &101&101&90 & 71 & 49 & 29 & 14 &  5 & 1 \\ \hline
    \end{array}
    \]

    Ví dụ, số hoán vị của 6 phần tử có 7 hoặc 8 nghịch thế là 101.

</body>